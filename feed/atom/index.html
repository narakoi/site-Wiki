<?xml version='1.0' encoding='UTF-8'?>
<feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-CN"><id>https://wiki.koi.cat/</id><title>Escape Wiki</title><updated>2020-03-24T21:34:13.079391+08:06</updated><author><name>koi</name><email>narakyzlily@gmail.com</email></author><link href="https://wiki.koi.cat/" rel="alternate"/><generator uri="https://lkiesow.github.io/python-feedgen" version="0.9.0">python-feedgen</generator><logo>https://cdn.jsdelivr.net/gh/narakoi/wiki@gh-pages/logo-头像.jpg</logo><subtitle>koi wiki</subtitle><entry><id>https://wiki.koi.cat/archives/Hexo 环境部署与发布/</id><title>Hexo 环境部署与发布</title><updated>2020-03-24T21:34:13.079576+00:00</updated><author><name>熊猫小A</name><email>narakyzlily@gmail.com</email><uri>https://koi.cat</uri></author><content>&lt;h3&gt;本地安装 Hexo&lt;/h3&gt;
&lt;p&gt;安装 node.js&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt-get install nodejs&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装 npm&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apt install npm&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;更新 npm&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;npm update -g&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;npm 更换为国内源&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;npm config set registry https://registry.npm.taobao.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;更新 node.js&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo npm install -g n
sudo n latest&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装 Hexo&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo npm install -g hexo-cli&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;部署到远端&lt;/h3&gt;
&lt;h4&gt;Git&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;npm install hexo-deployer-git --save&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置站点 _config.yml&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;deploy:
  type: git
  repo: &amp;lt;repository url&amp;gt;
  branch: [branch]
  message: [message]&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;SFTP&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;npm install hexo-deployer-sftp --save&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置站点 _config.yml&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;deploy:
  type: sftp
  host: &amp;lt;host&amp;gt;
  user: &amp;lt;user&amp;gt;
  pass: &amp;lt;password&amp;gt;
  remotePath: [remote path]
  port: [port]
  privateKey: [path/to/privateKey]
  passphrase: [passphrase]
  agent: [path/to/agent/socket]&lt;/code&gt;&lt;/pre&gt;
</content><link href="https://wiki.koi.cat/archives/Hexo 环境部署与发布/" rel="alternate"/><published>2018-04-28T00:00:00+08:06</published></entry><entry><id>https://wiki.koi.cat/archives/部署 Typecho/</id><title>部署 Typecho</title><updated>2020-03-24T21:34:13.079545+00:00</updated><author><name>熊猫小A</name><email>narakyzlily@gmail.com</email><uri>https://koi.cat</uri></author><content>&lt;h2&gt;安装 LNMP 环境&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://lnmp.org/install.html"&gt;LNMP 一键安装包&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;添加虚拟主机&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://lnmp.org/faq/lnmp-vhost-add-howto.html"&gt;LNMP添加、删除虚拟主机及伪静态使用教程&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;注意选择是否允许伪静态要选择是，并选择 Typecho。不创建对应的同名数据库。&lt;/p&gt;
&lt;h2&gt;上传 Typecho 程序&lt;/h2&gt;
&lt;p&gt;上传至上面添加的虚拟主机对应文件夹&lt;/p&gt;
&lt;h2&gt;连接数据库&lt;/h2&gt;

&lt;pre&gt;&lt;code&gt;mysql -u root -p
CREATE DATABASE typecho DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;
quit&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;安装 Typeccho&lt;/h2&gt;
&lt;p&gt;注意数据库编码选择 utf8mb4&lt;/p&gt;
&lt;h2&gt;解决后台 404&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;/usr/local/nginx/conf/vhost&lt;/code&gt; 中站点对应的 nginx 配置文件中&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;include enable-php.conf;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;改为&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;include enable-php-pathinfo.conf;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;重启 Nginx ：&lt;code&gt;lnmp restart&lt;/code&gt;&lt;/p&gt;
&lt;h2&gt;开启 SSL，设置 301 转发&lt;/h2&gt;
&lt;p&gt;一份示例 nginx 配置文件：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;server
    {
        listen 443 ssl;
        ssl_certificate /path/to/fullchain.pem;    
        ssl_certificate_key /path/to/privkey.pem;
        #listen 80;
        #listen [::]:80;
        server_name example.com;
        index index.html index.htm index.php default.html default.htm default.php;
        root  /path/to/site;

        include typecho.conf;
        error_page   404   /404.html;

        # Deny access to PHP files in specific directory
        #location ~ /(wp-content|uploads|wp-includes|images)/.*\.php$ { deny all; }

        include enable-php-pathinfo.conf;

        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
        {
            expires      30d;
        }

        location ~ .*\.(js|css)?$
        {
            expires      12h;
        }

        location ~ /.well-known {
            allow all;
        }

        location ~ /\.
        {
            deny all;
        }

        access_log  /path/to/sitelog;
    }
server
{
    listen 80;
    server_name example.com;
    rewrite ^(.*) https://example.com$1 permanent;
}&lt;/code&gt;&lt;/pre&gt;
</content><link href="https://wiki.koi.cat/archives/部署 Typecho/" rel="alternate"/><published>2018-04-28T00:00:00+08:06</published></entry><entry><id>https://wiki.koi.cat/archives/Windows 上安装 Hexo/</id><title>Windows 上安装 Hexo</title><updated>2020-03-24T21:34:13.079510+00:00</updated><author><name>熊猫小A</name><email>narakyzlily@gmail.com</email><uri>https://koi.cat</uri></author><content>&lt;p&gt;首先，下载安装 Node.js ：&lt;a href="https://nodejs.org/en/"&gt;Download for Windows (x64)&lt;/a&gt; 。&lt;/p&gt;
&lt;p&gt;更改 NPM 镜像：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;npm config set registry https://registry.npm.taobao.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;安装 Hexo：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;npm install -g hexo&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;部署到远端&lt;/h3&gt;
&lt;h4&gt;Git&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;npm install hexo-deployer-git --save&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置站点 _config.yml&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;deploy:
  type: git
  repo: &amp;lt;repository url&amp;gt;
  branch: [branch]
  message: [message]&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;SFTP&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;npm install hexo-deployer-sftp --save&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;配置站点 _config.yml&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;deploy:
  type: sftp
  host: &amp;lt;host&amp;gt;
  user: &amp;lt;user&amp;gt;
  pass: &amp;lt;password&amp;gt;
  remotePath: [remote path]
  port: [port]
  privateKey: [path/to/privateKey]
  passphrase: [passphrase]
  agent: [path/to/agent/socket]&lt;/code&gt;&lt;/pre&gt;
</content><link href="https://wiki.koi.cat/archives/Windows 上安装 Hexo/" rel="alternate"/><published>2018-05-04T00:00:00+08:06</published></entry><entry><id>https://wiki.koi.cat/archives/自定义 Hexo 文章链接形式/</id><title>自定义 Hexo 文章链接形式</title><updated>2020-03-24T21:34:13.079452+00:00</updated><author><name>熊猫小A</name><email>narakyzlily@gmail.com</email><uri>https://koi.cat</uri></author><content>&lt;p&gt;Hexo 文章默认采用 &lt;code&gt;年/月/日/标题&lt;/code&gt; 这样的永久链接形式。这个在站点&lt;code&gt;_config.yml&lt;/code&gt;中的&lt;code&gt;permalink&lt;/code&gt;字段即可更改。可以使用任何的字符作为路径，例如，我希望所有的文章链接形式都是：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://imalan.cn/archives/1
http://imalan.cn/archives/2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;也就是&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://imalan.cn/archives/[cid]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;那么就把&lt;code&gt;permalink&lt;/code&gt;改为&lt;code&gt;archives/:cid&lt;/code&gt;。其中的 &lt;code&gt;:cid&lt;/code&gt; 在 &lt;code&gt;hexo g&lt;/code&gt; 这一步时 Hexo 会从文章的头部提取，因此需要在每篇文章的头部添加 cid 信息，例如：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;layout: post
title: 自定义 Hexo 文章链接形式 
date: 2018-07-30
author: 熊猫小A
toc: ture
cid: 1
categories: 
  - 建站
  - Hexo
tags:
  - 建站&lt;/code&gt;&lt;/pre&gt;
</content><link href="https://wiki.koi.cat/archives/自定义 Hexo 文章链接形式/" rel="alternate"/><published>2018-07-30T00:00:00+08:06</published></entry></feed>